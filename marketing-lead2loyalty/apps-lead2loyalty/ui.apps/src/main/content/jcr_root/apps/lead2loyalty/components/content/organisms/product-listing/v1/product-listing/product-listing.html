<sly data-sly-use.template="core/wcm/components/commons/v1/templates.html"
	 data-sly-call="${template.placeholder @ isEmpty='true'}"
	 data-sly-use.productListingModel="com.deloitte.aem.lead2loyalty.core.models.ProductListingModel" />

<div class="plp-products ${properties.marginTop} ${properties.mobileMarginTop} ${properties.marginBottom} ${properties.mobileMarginBottom}"
	 data-product-endpoint="/content/lead2loyalty/_jcr_content/servlets/product-data.json"
	 data-rootpage=${properties.rootPagePath}>
</div>

<!-- ---------------------------------------------------------------------------------------

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script type="text/javascript">

	var rootPath = '${properties.rootPagePath @ context="scriptString"}'

	if(rootPath !== "") {

    $.ajax({
        type: "GET",
        url: "/content/lead2loyalty/_jcr_content/servlets/product-data.json",
        data: {"rootPage" : rootPath},
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (response) {

        },
        error: function (response) {
            var responseTextObject = jQuery.parseJSON(response.responseText);
        }
    });

}
</script>

-------------------------------------------------------------------------------------------------- -->



<!-- Body -->
<div class="container my-5 plp-container">
	<div class="row">
		<div class="col-3">
			<div class="d-flex justify-content-between">
				<div class="fw-bold fs-4">Filter</div>
				<button class="btn btn-link">Clear All</button>
			</div>

			<sly data-sly-list.accordionMap="${productListingModel.accordionMap}">
				<div class="accordionFilter" id="product-${accordionMapList.index}">
					<div class="card-header fw-bold my-2" id="headingOne">
						<div class="cardTitle"
								data-toggle="collapse"
								data-target="#panel-${accordionMapList.index}"
								aria-expanded="true"
								aria-controls="collapseOne" data-title="${accordionMap}">
							${accordionMap}
						</div>
					</div>

					<sly data-sly-test.accordionList="${productListingModel.accordionMap[accordionMap]}">
						<div data-sly-list.accList="${accordionList}"
							 id="panel-${accordionMapList.index}"
							 class="collapse panel show"
							 aria-labelledby="headingOne"
							 data-parent="product-${accordionMapList.index}">
							<div class="card-body my-3 ms-4" data-sly-test="${accList.title}">${accList.title}</div>
						</div>
					</sly>
				</div>
			</sly>
		</div>


		<div class="col-9 d-flex flex-wrap p-2 justify-content-between">
			<div class="container px-4 d-flex flex-wrap">
			<div class="d-flex flex-row w-100 justify-content-end">
				<div>
                    <label for="sort">Sort by </label>
                    <select name="sort" id="sort" class="border-0 border-bottom">
                        <option value="Best seller">Best seller</option>
                        <option value="Popularity">Popularity</option>
                    </select>
				</div>
			</div>
				<div class="row gx-3 d-flex flex-wrap"  data-sly-list.product="${productListingModel.productList}">
					<div class="col-sm-4 my-3 resultsWrapper product-list-tile" style="min-width: 30%" id="product-${productList.index}-results" data-parent="${product.parentTitle}">
						<a href="${product.path}" class="text-decoration-none">
							<div class="p-3 shadow-lg">
								<img src="${product.image}" class="card-img-top" alt="product image" />
								<div class="card-body mt-3">
									<h5 class="card-text card-name-wrap">
                                      ${product.description}
                                    </h5>
								</div>
							</div>
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>