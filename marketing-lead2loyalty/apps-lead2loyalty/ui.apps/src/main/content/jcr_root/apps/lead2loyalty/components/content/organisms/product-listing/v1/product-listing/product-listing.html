<sly data-sly-use.template="core/wcm/components/commons/v1/templates.html"
	 data-sly-call="${template.placeholder @ isEmpty='true'}"
	 data-sly-use.productListingModel="com.deloitte.aem.lead2loyalty.core.models.ProductListingModel" />

<div class="plp-products ${properties.marginTop} ${properties.mobileMarginTop} ${properties.marginBottom} ${properties.mobileMarginBottom}"
	 data-product-endpoint="/content/lead2loyalty/_jcr_content/servlets/product-data.json"
	 data-rootpage=${properties.rootPagePath}>
</div>

<!--/* ---------------------------------------------------------------------------------------

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script type="text/javascript">

	var rootPath = '${properties.rootPagePath @ context="scriptString"}'

	if(rootPath !== "") {

    $.ajax({
        type: "GET",
        url: "/content/lead2loyalty/_jcr_content/servlets/product-data.json",
        data: {"rootPage" : rootPath},
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (response) {

        },
        error: function (response) {
            var responseTextObject = jQuery.parseJSON(response.responseText);
        }
    });

}
</script>

-------------------------------------------------------------------------------------------------- */-->

<!--/* ----------------- Body ------------------ */-->

<div class="container my-5 plp-container">
	<div class="row container">
		<div class="col-md-3 col-sm-12">
			<div class="d-flex justify-content-between">
				<div class="fw-bold fs-4">${properties.filterLabel}</div>
				<button class="btn btn-link clear-all-btn">${properties.clearFilterLabel}</button>
			</div>

			<!--/* ----------------- accordian start ------------------ */-->
			<div id="accordion" class="category-filter">
				<sly data-sly-list.accordionMap="${productListingModel.accordionMap}">
					<div>
						<div class="card-header my-2" id="headingOne">
							<button class="btn fw-bold filter-header w-100 d-flex"
									data-toggle="collapse"
									data-target="#collapse-${accordionMapList.index}"
									aria-expanded="true"
									aria-controls="collapse-${accordionMapList.index}"
									data-title="${accordionMap}" data-name="${productListingModel.pageNameMap[accordionMap]}">
								<span>${accordionMap}</span>
								<span class="arrow-icons arrow-down"><i class="fa-solid fa-sm fa-angle-down"></i></span>
								<span class="arrow-icons arrow-up"><i class="fa-solid fa-sm fa-angle-up"></i></span>
							</button>
						</div>
						<sly data-sly-test.accordionList="${productListingModel.accordionMap[accordionMap]}">
							<div id="collapse-${accordionMapList.index}"
								 class="collapse show"
								 aria-labelledby="headingOne"
								 data-parent="#accordion">
								<div class="card-body">
									<ul class="list-group ms-4"
										data-sly-list.accList="${accordionList}">
										<li class="list-group-item border-0"><a class="text-decoration-none" href="${accList.path}">${accList.title}</a></li>
									</ul>
								</div>
							</div>
						</sly>
					</div>
				</sly>
			</div>
			<!--/* ----------------- accordian end ------------------ */-->
		</div>

		<!--/* ----------------- results start ------------------ */-->
		<div class="col-md-9 d-flex flex-wrap p-2 justify-content-between col-sm-12">
			<div class="container px-4 d-flex flex-column">
				<div class="d-flex flex-row w-100 justify-content-end">
					<div>
						<label for="sort">${properties.sortByLabel} </label>
						<select name="sort" id="sort" class="border-0 border-bottom">
							<option value="Best seller">${properties.sortBestSellerLabel}</option>
							<option value="Popularity">${properties.sortPopularityLabel}</option>
						</select>
					</div>
				</div>

				<div class="row gx-3 d-flex flex-wrap" data-sly-list.product="${productListingModel.productList}">
					<div class="col-md-4 col-sm-6 col-xs-12 my-3 resultsWrapper product-list-tile" style="min-width: 30%" id="product-results" data-parent="${product.parentTitle}" data-name="${product.parentName}">
						<a href="${product.path}" class="text-decoration-none">
							<div class="card shadow-lg">
								<img src="${product.image}" class="card-img-top" alt="product image" />
								<div class="card-body">
									<h5 class="card-text card-name-wrap">
										${product.description}
									</h5>
								</div>
							</div>
						</a>
					</div>
				</div>
			</div>
		</div>
		<!--/* ----------------- results end ------------------ */-->
	</div>
</div>
